From 83c529151ab0d4a813e3f6a3e293fff75d468519 Mon Sep 17 00:00:00 2001
From: "Liu, Jinsong" <jinsong.liu@intel.com>
Date: Tue, 28 Feb 2012 05:15:46 +0000
Subject: KVM: x86: expose Intel cpu new features (HLE, RTM) to guest
References: fate#313616
Patch-mainline: v3.5
Git-commit: 83c529151ab0d4a813e3f6a3e293fff75d468519

Intel recently release 2 new features, HLE and RTM.
Refer to http://software.intel.com/file/41417.
This patch expose them to guest.

Signed-off-by: Liu, Jinsong <jinsong.liu@intel.com>
Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
Signed-off-by: Avi Kivity <avi@redhat.com>
Acked-by: Bruce Rogers <brogers@suse.com>
---
 arch/x86/kvm/x86.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: b/arch/x86/kvm/x86.c
===================================================================
--- a/arch/x86/kvm/x86.c
+++ b/arch/x86/kvm/x86.c
@@ -2450,7 +2450,7 @@ static void do_cpuid_ent(struct kvm_cpui
 
 	/* cpuid 7.0.ebx */
 	const u32 kvm_supported_word9_x86_features =
-		F(BMI1) | F(AVX2) | F(SMEP) | F(BMI2) | F(FSGSBASE) | F(ERMS) |
+		F(BMI1) | F(HLE) | F(AVX2) | F(SMEP) | F(BMI2) | F(RTM) | F(FSGSBASE) | F(ERMS) |
 		f_invpcid;
 
 	/* all calls to cpuid_count() should be made on the same cpu */
