From: Jiri Bohac <jbohac@suse.cz>
Subject: tipc: fix an infoleak in tipc_nl_compat_link_dump
Git-commit: 5d2be1422e02ccd697ccfcd45c85b4a26e6178e2
Patch-mainline: v4.7
References: bsc#983212, CVE-2016-5243

link_info.str is a char array of size 60. Memory after the NULL
byte is not initialized. Sending the whole object out can cause
a leak.

Signed-off-by: Jiri Bohac <jbohac@suse.cz>

---
 net/tipc/node.c |    2 ++
 1 file changed, 2 insertions(+)

--- a/net/tipc/node.c
+++ b/net/tipc/node.c
@@ -415,6 +415,8 @@
 		return NULL;
 	}
 
+	memset(&link_info, 0, sizeof(link_info));
+
 	/* Add TLV for broadcast link */
 	link_info.dest = htonl(tipc_cluster_mask(tipc_own_addr));
 	link_info.up = htonl(1);
