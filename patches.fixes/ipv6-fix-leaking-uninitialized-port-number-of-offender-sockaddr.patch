From: Hannes Frederic Sowa <hannes@stressinduktion.org>
Date: Sat, 23 Nov 2013 07:22:33 +0100
Subject: ipv6: fix leaking uninitialized port number of offender sockaddr
Git-commit: 1fa4c710b6fe7b0aac9907240291b6fe6aafc3b8
Patch-mainline: v3.13-rc3
References: bsc#853040, CVE-2013-7263

Offenders don't have port numbers, so set it to 0.

Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Borislav Petkov <bp@suse.de>
---
 net/ipv6/datagram.c | 1 +
 1 file changed, 1 insertion(+)

Index: kernel/net/ipv6/datagram.c
===================================================================
--- kernel.orig/net/ipv6/datagram.c	2014-05-18 23:04:57.820187425 +0200
+++ kernel/net/ipv6/datagram.c	2014-05-18 23:05:41.624187347 +0200
@@ -374,6 +374,7 @@ int ipv6_recv_error(struct sock *sk, str
 		sin->sin6_family = AF_INET6;
 		sin->sin6_flowinfo = 0;
 		sin->sin6_scope_id = 0;
+		sin->sin6_port = 0;
 		if (skb->protocol == htons(ETH_P_IPV6)) {
 			ipv6_addr_copy(&sin->sin6_addr, &ipv6_hdr(skb)->saddr);
 			if (np->rxopt.all)
